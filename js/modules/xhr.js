/*!
  Copyright 2013 The Impact Plus. All rights reserved.

  YOU ARE PERMITTED TO:
  * Transfer the Software and license to another party if the other party agrees to accept the terms and conditions of this License Agreement. The license holder is responsible for a transfer fee of $50.95 USD. The license must be at least 90 days old or not transferred within the last 90 days;
  * Modify source codes of the software and add new functionality that does not violate the terms of the current license;
  * Customize the Software's design and operation to suit the internal needs of your web site except to the extent not permitted under this Agreement;
  * Create, sell and distribute applications/modules/plugins which interface (not derivative works) with the operation of the Software provided the said applications/modules/plugins are original works or appropriate 3rd party license(s) except to the extent not permitted under this Agreement;
  * Create, sell and distribute by any means any templates and/or designs/skins which allow you or other users of the Software to customize the appearance of Impact Plus provided the said templates and or designs/skins are original works or appropriate 3rd party license(s) except to the extent not permitted under this Agreement.

  YOU ARE "NOT" PERMITTED TO:
  * Use the Software in violation of any US/India or international law or regulation.
  * Permit other individuals to use the Software except under the terms listed above;
  * Reverse-engineer and/or disassemble the Software for distribution or usage outside your domain if it is not an unlimited licence version;
  * Use the Software in such as way as to condone or encourage terrorism, promote or provide pirated Software, or any other form of illegal or damaging activity;
  * Distribute individual copies of proprietary files, libraries, or other programming material in the Software package.
  * Distribute or modify proprietary graphics, HTML, or CSS packaged with the Software for use in applications other than the Software;
  * Use the Software in more than one instance or location (URL, domain, sub-domain, etc.) without prior written consent from IMPACT PLUS;
  * Modify the software and/or create applications and modules which allow the Software to function in more than one instance or location (URL, domain, sub-domain, etc.) without prior written consent from IMPACT PLUS;
  * Copy the Software and install that single program for simultaneous use on multiple machines without prior written consent from IMPACT PLUS;
*/;var ipXhr=Backbone.Model.extend({initialize:function(){if(!window.ipExtend){throw new Error("'ipExtend' does not exists in window")}if(typeof XMLHttpRequest!=="undefined"){this.xhr=new XMLHttpRequest()}else{var b=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"];for(var c=0,a=b.length;c<a;c++){try{this.xhr=new ActiveXObject(b[c]);break}catch(d){throw new Error("Cannot initialize 'XMLHttpRequest' object ("+d+")")}}}if(!this.xhr){throw new Error("Cannot initialize 'XMLHttpRequest' object")}this.xhr.params={};this.xhr.do_call=this.call;this.xhr.do_check=this.check;this.xhr.callbacks={};this.xhr.res_mode="json";this.xhr.arguments={};this.xhr.onreadystatechange=this.ensure;return this},abort:function(){this.xhr.abort()},open:function(b,c,a){c=(c||"POST").toString().toUpperCase();this.xhr.open(c,b,true);if(a!==true){this.header("Content-Type","application/x-www-form-urlencoded");this.header("X-Requested-With","XMLHttpRequest")}},header:function(a,b){if(!arguments.length){return false}if(typeof a=="string"){this.xhr.setRequestHeader(a,b)}else{if(typeof a=="object"){for(i in a){this.xhr.setRequestHeader(i,a[i])}}}},params:function(a,b){if(!arguments.length){return false}if(typeof a=="string"&&b){this.xhr.params[a]=b}else{if(typeof a=="string"&&!b){this.xhr.params=a}else{if(typeof a=="object"){for(i in a){this.xhr.params[i]=a[i]}}}}},callback:function(a,b){if(!arguments.length){return false}if(typeof a=="string"){this.xhr.callbacks[a]=b}else{if(typeof a=="object"){for(i in a){this.xhr.callbacks[i]=a[i]}}}},response_mode:function(a){a=a||"html";this.xhr.res_mode=a},arguments:function(a,b){if(!arguments.length){return false}if(typeof a=="string"){this.xhr.arguments[a]=b}else{if(typeof a=="object"){for(i in a){this.xhr.arguments[i]=a[i]}}}},send:function(e){var c=["onabort","onerror","onload","onloadend","onloadstart","onprogress"];for(x in c){if(this.xhr.callbacks&&this.xhr.callbacks[c[x]]){var d=c[x];this.xhr[d]=function(f){if(d==="onprogress"){this.do_call(d,f)}else{this.do_call(d)}}}}var b=$.cookie("PHPSESSID");var a={charset_test:"€,´,€,´,水,Д,Є",request_id:"xhr-"+unds.uniqueId(),request_sd:(!unds.isEmpty(b)&&b!="undefined")?b:0,browser:$.browser};if(this.xhr.params&&typeof this.xhr.params=="object"){this.xhr.params=$.extend(this.xhr.params,a);this.xhr.params=http_build_query(this.xhr.params)}if(e){this.xhr.send(e)}else{this.xhr.send(this.xhr.params)}this.destroy()},ensure:function(){if(this.readyState<4){return false}if(this.status!==200){this.do_call("onerror",{code:this.status,message:this.statusText,state:this.readyState});return false}if(this.readyState===4&&this.status==200){switch(this.res_mode){case"json":if(this.do_check()){this.do_call("onsuccess")}else{this.do_call("onerror",{code:200,message:"Parse Error",state:4})}break;case"xml":if(this.do_check()){this.do_call("onsuccess")}else{this.do_call("onerror",{code:200,message:"Parse Error",state:4})}break;default:var a=this.response||this.responseText;if(a.replace(/^\s+|\s+$/g,"")!=""){this.do_call("onsuccess")}else{this.do_call("onerror",{code:200,message:"Empty Response",state:4})}break}return false}},check:function(a){a=$.trim(a||this.response||this.responseText);if(a){if(this.res_mode=="json"){if(!window.JSON){throw new Error("'JSON' does not exists in Window")}try{a=window.JSON.parse(a)}catch(b){a=false}if(a){return a}}else{if(this.res_mode=="xml"){a=this.responseXML;return a}else{return true}}}return false},call:function(c,e){var a=this.do_check(this.response||this.responseText);var d=this.response||this.responseText;a=a||d;c=(typeof c==="string")?[c]:c;for(x in c){var b=unds.clone(unds.isArray(this.arguments[c[x]])?this.arguments[c[x]]:[]);if(e){b.unshift(e)}if(c[x]!==undefined&&this.callbacks!==undefined&&this.callbacks[c[x]]!==undefined){if(!unds.isEmpty(b)){if(c[x]!=="onprogress"){b.unshift(a)}call_user_func_array(this.callbacks[c[x]],b)}else{if(typeof this.callbacks[c[x]]=="function"){this.callbacks[c[x]](a)}}}}}});