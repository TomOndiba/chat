/*!
  Copyright 2013 The Impact Plus. All rights reserved.

  YOU ARE PERMITTED TO:
  * Transfer the Software and license to another party if the other party agrees to accept the terms and conditions of this License Agreement. The license holder is responsible for a transfer fee of $50.95 USD. The license must be at least 90 days old or not transferred within the last 90 days;
  * Modify source codes of the software and add new functionality that does not violate the terms of the current license;
  * Customize the Software's design and operation to suit the internal needs of your web site except to the extent not permitted under this Agreement;
  * Create, sell and distribute applications/modules/plugins which interface (not derivative works) with the operation of the Software provided the said applications/modules/plugins are original works or appropriate 3rd party license(s) except to the extent not permitted under this Agreement;
  * Create, sell and distribute by any means any templates and/or designs/skins which allow you or other users of the Software to customize the appearance of Impact Plus provided the said templates and or designs/skins are original works or appropriate 3rd party license(s) except to the extent not permitted under this Agreement.

  YOU ARE "NOT" PERMITTED TO:
  * Use the Software in violation of any US/India or international law or regulation.
  * Permit other individuals to use the Software except under the terms listed above;
  * Reverse-engineer and/or disassemble the Software for distribution or usage outside your domain if it is not an unlimited licence version;
  * Use the Software in such as way as to condone or encourage terrorism, promote or provide pirated Software, or any other form of illegal or damaging activity;
  * Distribute individual copies of proprietary files, libraries, or other programming material in the Software package.
  * Distribute or modify proprietary graphics, HTML, or CSS packaged with the Software for use in applications other than the Software;
  * Use the Software in more than one instance or location (URL, domain, sub-domain, etc.) without prior written consent from IMPACT PLUS;
  * Modify the software and/or create applications and modules which allow the Software to function in more than one instance or location (URL, domain, sub-domain, etc.) without prior written consent from IMPACT PLUS;
  * Copy the Software and install that single program for simultaneous use on multiple machines without prior written consent from IMPACT PLUS;
*/(function(j){var a={target:!1,list:{},search:"name",label:"Add peoples to this chat",limit:!1,onsearch:function(){},onremove:function(){}},f=!1,d=!1,i={init:function(c){var e=j.extend({},a,c);if(j(".uiLayer:data(uiTokenizer)").length){f=j(".uiLayer:data(uiTokenizer)"),d=f.find(".uiTypeaheadView ul")}else{c=ipcl().wrap_elm.cn("div",{"class":"uiContextualLayerPositioner uiLayer uiContextualLayerPositionerFixed"}).data("uiTokenizer",!0);var b=c.cn("div",{"class":"uiContextualLayer uiContextualLayerBelowLeft"}).cn("div",{"class":"uiTypeaheadView uiContextualTypeaheadView uiInlineTokenizerView"},'<ul class="compact" role="listbox"></ul>');f=c;d=j("ul",b)}return this.each(function(){var g=j(this);var h=g.parents(".uiTokenizer:first").cn("div",{"class":"ui-mask-placeholder"},e.label,"prepend");g.data({opts:e}).width("20px");g.on("keyup keydown focus",function(p){if($(this).val().length){h.hide(0)}else{if(!g.parents(".uiTokenizer:first").find(".tokenarea .uiToken").length){h.show(0)}}65===p.keyCode&&p.ctrlKey&&j(this).select();if("keyup"===p.type||"keydown"===p.type){if(40===p.keyCode&&j("li",d).length){if("keydown"===p.type){return}p.preventDefault();p.stopPropagation();p=j("li.selected",d).next("li:first");p.length?(j("li",d).removeClass("selected"),p.addClass("selected")):(j("li",d).removeClass("selected"),j("li:first",d).addClass("selected"));return}if(38===p.keyCode&&j("li",d).length){if("keydown"===p.type){return}p.preventDefault();p.stopPropagation();p=j("li.selected",d).prev("li:first");p.length?(j("li",d).removeClass("selected"),p.addClass("selected")):(j("li",d).removeClass("selected"),j("li:last",d).addClass("selected"));return}if(13===p.keyCode&&j("li.selected",d).length){if("keydown"===p.type){return}p.preventDefault();p.stopPropagation();j("li.selected",d).trigger("mousedown");return}}d.empty();f.hide(0);if("keydown"===p.type){8!==p.keyCode||j(this).val().length?40===p.keyCode&&f.is(":visible"):(p.preventDefault(),p=j(".tokenarea",e.target).find(".uiToken:last"),p.length&&p.find("a.remove").trigger("click"))}else{if(p=j.trim(j(this).val()),p.length){var r=j(this).data("opts").list||{},q=g.utokenizer("get","name"),q=ipos(r,e.search,p,!1,e.limit,q);if(!unds.isEmpty(q)&&(p=parseInt(j(this).offset().left),r=parseInt(j(this).offset().top+j(this).outerHeight(!0)),f.show(0).css({left:p+"px",top:r+"px",zIndex:401}),"function"===typeof e.onsearch)){for(x in q){call_user_func_array(e.onsearch,[d,q[x],g])}var q=parseInt(j(".uiTypeaheadView",f).width()),l=parseInt(j(".uiTypeaheadView",f).height());p+q>j(window).width()&&f.css({left:j(window).width()-q-5});r+l>j(window).height()&&f.css({top:j(window).height()-l-5})}}}});g.on("blur",function(l){d.empty();f.hide(0)})})},clear:function(){var c=j(this),b=c.data("opts");j(".tokenarea",b.target).empty()},add:function(k,b){var p=j(this),e=p.data("opts");if(j(".tokenarea",e.target).find("input[name=uitokens][value='"+k+"']").length){p.val("").trigger("focus")}else{p.parents(".uiTokenizer:first").find(".ui-mask-placeholder").hide();var c=j(".tokenarea",e.target).removeClass("hidden_elem").cn("span",{"class":"removable uiToken"},b),h=c.cn("input",{type:"hidden",value:k,name:"uitokens",autocomplete:"off"}),g=c.cn("input",{type:"hidden",value:b,name:"text_uitokens",autocomplete:"off"});c.cn("a",{"class":"remove uiCloseButton uiCloseButtonSmall",title:"Remove "+name,href:"#"},'<i class="icon-remove"></i>').on("click",function(l){l.preventDefault();l.stopPropagation();l=h.val();var m=g.val();c.remove();"function"===typeof e.onremove&&call_user_func_array(e.onremove,[l,m,p]);j(".uiToken",e.target).length||j(".tokenarea",e.target).addClass("hidden_elem");p.focus()});p.val("").trigger("focus");return this}},get:function(c){c=c?"id"===c?"uitokens":"text_uitokens":!1;var b=j(this).data("opts"),b=j("input",b.target).serializeObject(),b=c?b[c]:b;return b=unds.isArray(b)?b:b?[b]:[]},set:function(c){var b=j(this),e=b.data("opts");e.list=c;b.data("opts",e);return this}};j.fn.utokenizer=function(b){if(i[b]){return i[b].apply(this,Array.prototype.slice.call(arguments,1))}if("object"!==typeof b&&b){j.error("Method "+b+" does not exist on jQuery.utokenizer")}else{return i.init.apply(this,arguments)}}})(jQuery);